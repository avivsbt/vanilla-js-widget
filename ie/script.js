
var sponsoredRecommendations = [
  {
    "type": "video",
    "thumbnail": [
      {
        "url": "https://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/http%3A%2F%2Fcdn.taboola.com%2Flibtrc%2Fstatic%2Fthumbnails%2FGETTY_IMAGES%2FSKP%2F649484148__ZsRYIPZP.jpg",
        "width": "724",
        "height": "483"
      }
    ],
    "name": "Találja meg a tökéletes társat BEJELENTKEZÉS",
    "created": "Sun, 10 Feb 2019 15:35:10 UTC",
    "branding": "BE2",
    "duration": "0",
    "views": "0",
    "categories": [
      "hu"
    ],
    "id": "~~V1~~-1682229752082722688~~z_HiftLc8Eya1R9j6L6lhqP9W9b5SOUSJ5w2VOcNB3R_IyVF-PUMhnzhEnt6YC709ch5D-rQaOj4yk9c-8GzA93dMQi63Jan54enSgBywwjIOz1tzDl5IOE_3PNy0q-e0Hsvo8A8-cMJaEI98_kehubQoSlTUdjwxbQzyd-hi4s",
    "origin": "sponsored",
    "url": "https://api.taboola.com/1.0/json/taboola-templates/recommendations.notify-click?app.type=desktop&app.apikey=f9040ab1b9c802857aa783c469d0e0ff7e7366e4&response.id=__f45f370c6ddfb69fa43ce2eb448ddc60__7b210761016759c41185912d29649879&response.session=v2_ebb283d4618149bde2851bf1bf0d3fe7_b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970_1711862768_1711862768_CNawjgYQswsYgMrjl-kxIAEoATBmOIjrCkCvkBBI9dLYA1D___________8BWABgAGjGx7Pdg7-4oF5wAQ&item.id=%7E%7EV1%7E%7E-1682229752082722688%7E%7Ez_HiftLc8Eya1R9j6L6lhqP9W9b5SOUSJ5w2VOcNB3R_IyVF-PUMhnzhEnt6YC709ch5D-rQaOj4yk9c-8GzA93dMQi63Jan54enSgBywwjIOz1tzDl5IOE_3PNy0q-e0Hsvo8A8-cMJaEI98_kehubQoSlTUdjwxbQzyd-hi4s&item.type=video&sig=d3eb379a4659bcb069c96260ec57d88589c8e65bc6b7&redir=https%3A%2F%2Fwww.be2.hu%2Fdlpm%2Fpinboard-hu-aff.html%3Fpartnerid%3D01HUb_200899_216712_1%26linkid%3Dsi_20_90r_hu_m2_wNVV4A5SL3QRCN9KHO2K37CA%26accid%3D5227%26subid1%3Dsi_20_90r_hu_m2%26subid2%3DwNVV4A5SL3QRCN9KHO2K37CA%26visid%3D1287350333%26utm_source%3Dtaboola%26utm_medium%3Dreferral%26tblci%3DGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCiKrKi_m8eUvjA%23tblciGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCiKrKi_m8eUvjA&ui=b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970&cpb=GIkFIJz__________wEqFnRhYm9vbGFzeW5kaWNhdGlvbi5jb20yCHRyYzAwMjY3OICElKcFQIjrCkivkBBQ9dLYA1j___________8BYwjTVxDGcxgwZGMIm10QrXoYMmRjCNcWENUfGCNkYwjSAxDgBhgIZGMIlhQQnRwYGGRjCO8DEIoHGAlkYwilWRC9dRg-ZGMI4f__________ARDh__________8BGB9kYwjR__________8BENH__________wEYL2R4AYABrE2IAcm7s-oBkAEXmAGAyuOX6THbARAB3AE"
  },
  {
    "type": "video",
    "thumbnail": [
      {
        "url": "https://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/http%3A%2F%2Fcdn-elle.ladmedia.fr%2Fvar%2Fplain_site%2Fstorage%2Fimages%2Felle-a-table%2Fque-faire-avec%2Fidees-de-menus%2F20-recettes-d-epinards-frais-qui-font-envie%2F46798671-1-fre-FR%2F20-recettes-d-epinards-frais-qui-font-envie_reference.jpg"
      }
    ],
    "description": "C’est au printemps qu’on craque sur les jeunes et fraîches pousses d’épinards. Juste assaisonnées dans une salade, servies avec du poisson ou de la viande, elles sont faciles à cuisiner et apportent la touche de vert qui fait du bien.",
    "name": "20 recettes d’épinards frais qui font envie - Elle à Table",
    "created": "Wed, 12 Apr 2023 00:00:00 UTC",
    "branding": "Cuisine",
    "duration": "0",
    "views": "0",
    "categories": [
      "fr"
    ],
    "id": "~~V1~~8953297628955691400~~5khWG3r4qdI2H7O_KccoPngEqsl8ynEPWU6g_gQg9GWKANNcaafC-0QP27WPePejFjdyaAfJpxf93xCM8jBXM3NvVRSOQU3KG74h40zV1xE3Jpvz87tKk9szttPlHlQ16geeKmBzsC8tOXDDFySaFY8XwLbI--WZuj80gUuMjckv-g3BPZqv3IrMOsHf8vWe",
    "origin": "sponsored",
    "url": "https://api.taboola.com/1.0/json/taboola-templates/recommendations.notify-click?app.type=desktop&app.apikey=f9040ab1b9c802857aa783c469d0e0ff7e7366e4&response.id=__f45f370c6ddfb69fa43ce2eb448ddc60__7b210761016759c41185912d29649879&response.session=v2_ebb283d4618149bde2851bf1bf0d3fe7_b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970_1711862768_1711862768_CNawjgYQswsYgMrjl-kxIAEoATBmOIjrCkCvkBBI9dLYA1D___________8BWABgAGjGx7Pdg7-4oF5wAQ&item.id=%7E%7EV1%7E%7E8953297628955691400%7E%7E5khWG3r4qdI2H7O_KccoPngEqsl8ynEPWU6g_gQg9GWKANNcaafC-0QP27WPePejFjdyaAfJpxf93xCM8jBXM3NvVRSOQU3KG74h40zV1xE3Jpvz87tKk9szttPlHlQ16geeKmBzsC8tOXDDFySaFY8XwLbI--WZuj80gUuMjckv-g3BPZqv3IrMOsHf8vWe&item.type=video&sig=2ed671b4b7bdde6d159315d6bc2b6e44f1b623a058e0&redir=http%3A%2F%2Fwww.elle.fr%2FElle-a-Table%2FQue-faire-avec%2Fidees-de-menus%2F20-recettes-d-epinards-frais-qui-font-envie%3Futm_source%3Dtaboola%26utm_medium%3Dreferral%26tblci%3DGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCjxp72duPGN_tIB%23tblciGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCjxp72duPGN_tIB&ui=b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970&cpb=GIkFIJz__________wEqFnRhYm9vbGFzeW5kaWNhdGlvbi5jb20yCHRyYzAwMjY3OICElKcFQIjrCkivkBBQ9dLYA1j___________8BYwjTVxDGcxgwZGMIm10QrXoYMmRjCNcWENUfGCNkYwjSAxDgBhgIZGMIlhQQnRwYGGRjCO8DEIoHGAlkYwilWRC9dRg-ZGMI4f__________ARDh__________8BGB9kYwjR__________8BENH__________wEYL2R4AYABrE2IAcm7s-oBkAEXmAGAyuOX6THbARAB3AE"
  },
  {
    "type": "video",
    "thumbnail": [
      {
        "url": "https://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/http%3A%2F%2Ffeminin.niooz.fr%2Fcache%2Fmediaurl%2F600x400%2F333cec24315e3a68b70beaec147e71d2.jpg"
      }
    ],
    "description": "Apprenez à éviter les fautes de goût pendant votre shopping mode avec le guide shopping",
    "name": "Et si on osait les vêtements à franges ?",
    "created": "Mon, 14 Apr 2014 00:00:00 UTC",
    "branding": "Elle",
    "duration": "0",
    "views": "0",
    "categories": [
      "fr"
    ],
    "id": "~~V1~~-980276053837313327~~ZZjwieuFi0udh1RZS1JXsHgEqsl8ynEPWU6g_gQg9GWKANNcaafC-0QP27WPePej_D75KE7fubJO0yBBV-Kjn3NvVRSOQU3KG74h40zV1xE3Jpvz87tKk9szttPlHlQ17hW18gOeBKWEuq6da9CEkY8XwLbI--WZuj80gUuMjckv-g3BPZqv3IrMOsHf8vWe",
    "origin": "sponsored",
    "url": "https://api.taboola.com/1.0/json/taboola-templates/recommendations.notify-click?app.type=desktop&app.apikey=f9040ab1b9c802857aa783c469d0e0ff7e7366e4&response.id=__f45f370c6ddfb69fa43ce2eb448ddc60__7b210761016759c41185912d29649879&response.session=v2_ebb283d4618149bde2851bf1bf0d3fe7_b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970_1711862768_1711862768_CNawjgYQswsYgMrjl-kxIAEoATBmOIjrCkCvkBBI9dLYA1D___________8BWABgAGjGx7Pdg7-4oF5wAQ&item.id=%7E%7EV1%7E%7E-980276053837313327%7E%7EZZjwieuFi0udh1RZS1JXsHgEqsl8ynEPWU6g_gQg9GWKANNcaafC-0QP27WPePej_D75KE7fubJO0yBBV-Kjn3NvVRSOQU3KG74h40zV1xE3Jpvz87tKk9szttPlHlQ17hW18gOeBKWEuq6da9CEkY8XwLbI--WZuj80gUuMjckv-g3BPZqv3IrMOsHf8vWe&item.type=video&sig=3830180dbfbf480a7840492675fca7231a2d4d36cfd8&redir=http%3A%2F%2Fwww.elle.fr%2FMode%2FLe-guide-shopping%2FPrintemps-Ete-2014%2FEt-si-on-osait-les-vetements-a-franges%3Futm_source%3Dtaboola%26utm_medium%3Dreferral%26tblci%3DGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCiMxM_5trqlon4%23tblciGiCrpx0J_zVXHqMHAtiqF2Cvwt0mRL6yXH1u8Dm7Vf-PTyC5BCiMxM_5trqlon4&ui=b6575631-0b77-42a6-b9eb-53146b035dd3-tuctd027970&cpb=GIkFIJz__________wEqFnRhYm9vbGFzeW5kaWNhdGlvbi5jb20yCHRyYzAwMjY3OICElKcFQIjrCkivkBBQ9dLYA1j___________8BYwjTVxDGcxgwZGMIm10QrXoYMmRjCNcWENUfGCNkYwjSAxDgBhgIZGMIlhQQnRwYGGRjCO8DEIoHGAlkYwilWRC9dRg-ZGMI4f__________ARDh__________8BGB9kYwjR__________8BENH__________wEYL2R4AYABrE2IAcm7s-oBkAEXmAGAyuOX6THbARAB3AE"
  }
];
var sponsoredsElements = [];

function getSponsoredRecommendations() {
  var url = "http://api.taboola.com/1.0/json/taboola-templates/recommendations.get?app.type=desktop&app.apikey=f9040ab1b9c802857aa783c469d0e0ff7e7366e4&count=100&source.type=video&source.id="

  httpRequest(url, function (response) {
    console.log('httpRequest', response);
    // sponsoredRecommendations = response.list;
    generateBanner();
  });
}

function httpRequest(url, callback, options = { headers: {}, body: {} }) {

  var xhr = new XMLHttpRequest();

  xhr.onreadystatechange = function () {
    if (xhr.readyState === XMLHttpRequest.DONE) {
      if (xhr.status === 200) {
        callback(xhr.responseText);
      }
    }
  };

  xhr.open('GET', url);

  if (options && options.headers) {
    for (var header in options.headers) {
      if (options.headers.hasOwnProperty(header)) {
        xhr.setRequestHeader(header, options.headers[header]);
      }
    }
  } else {
    console.error("Options or options.headers is not defined.");
  }

  if (options && options.body) {
    xhr.send(options.body);
  } else {
    console.error("Options or options.body is not defined.");
  }

}

function generateBanner() {
  for (const element of sponsoredsElements) {
    var component = bannerImgComponent(sponsoredRecommendations[0]);
    if (sponsoredRecommendations.length > 0) {
      sponsoredRecommendations.shift();
    }
    element.appendChild(component);
  }
}

function bannerImgComponent(data) {
  var container = document.createElement('div');
  var template = document.createElement("template");

  template.innerHTML =
    '<div id="root">' +
    '   <a target="_blank" class="link">' +
    '       <img class="img"/>' +
    '       <h1 class="title"></h1>' +
    '   <a>' +
    '   <div class="type">' +
    '       <span class="branding"></span> | ' +
    '       <span class="origin"></span>' +
    '   </div>' +
    '</div>';

  var link = template.content.querySelector('.link');
  var img = template.content.querySelector('.img');
  var title = template.content.querySelector('.title');
  var origin = template.content.querySelector('.origin');
  var branding = template.content.querySelector('.branding');

  title.textContent = data.name;
  img.setAttribute('src', data.thumbnail[0].url);
  link.setAttribute('href', data.url);
  origin.textContent = data.origin;
  branding.textContent = data.branding;

  container.appendChild(template.content);

  return container;
}

document.addEventListener("DOMContentLoaded", function () {
  sponsoredsElements = document.getElementsByClassName('rwt');
  getSponsoredRecommendations();
});